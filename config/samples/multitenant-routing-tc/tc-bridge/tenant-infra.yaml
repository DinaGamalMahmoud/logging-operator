apiVersion: v1
kind: Namespace
metadata:
  name: infra
  labels:
    tenant: infra
---
apiVersion: telemetry.kube-logging.dev/v1alpha1
kind: Tenant
metadata:
  name: infra
  labels:
    collector: cluster
spec:
  subscriptionNamespaceSelectors:
    - matchLabels:
        tenant: infra
---
apiVersion: telemetry.kube-logging.dev/v1alpha1
kind: Subscription
metadata:
  name: infra
  namespace: infra
  labels:
    tenant: infra
spec:
  condition: "true"
  outputs:
    - name: infra-all
      namespace: infra
---
apiVersion: telemetry.kube-logging.dev/v1alpha1
kind: Output
metadata:
  name: infra-all
  namespace: infra
spec:
  otlp:
    endpoint: receiver-infra-collector.infra.svc.cluster.local:4317
    tls:
      insecure: true
---
apiVersion: telemetry.kube-logging.dev/v1alpha1
kind: Bridge
metadata:
  name: customer-a-infra
spec:
  sourceTenant: customer-a
  targetTenant: infra
  condition: "true"
---
apiVersion: telemetry.kube-logging.dev/v1alpha1
kind: Bridge
metadata:
  name: customer-b-infra
spec:
  sourceTenant: customer-b
  targetTenant: infra
  condition: "true"
---
apiVersion: opentelemetry.io/v1alpha1
kind: OpenTelemetryCollector
metadata:
  name: receiver-infra
  namespace: infra
spec:
  managementState: managed
  config: |
    receivers:
      otlp:
        protocols:
          grpc:

    exporters:
      debug:
        verbosity: detailed
    service:
        pipelines:
          logs:
            receivers: [otlp]
            exporters: [debug]
